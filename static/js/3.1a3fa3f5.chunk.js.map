{"version":3,"sources":["components/Paginator/styles.module.css","components/Users/Item/Item.module.css","components/Users/Users.module.css","state/users/api.js","state/users/actions.js","components/Paginator/Paginator.jsx","components/Users/Item/Item.jsx","components/Users/Users.jsx","components/Users/index.js"],"names":["module","exports","usersAPI","currentPage","pageSize","instanceAxios","get","response","data","id","post","delete","acceptAddFriend","userId","type","types","ADD_FRIEND","acceptDeleteFriend","DELETE_FRIEND","setCurrentPage","SET_CURRENT_PAGE","setWaitIsSubscribe","isFetching","TOGGLE_IS_WAIT_SUBSCRIBE","getUsersThunk","dispatch","a","TOGGLE_IS_FETCHING","users","items","SET_USERS","totalCount","SET_TOTAL_COUNT","Error","Paginator","className","portionSize","useDispatch","useState","portionNumber","setPortionNumber","pageCount","Math","ceil","pages","i","push","portionCount","leftMostElemPortion","rightMostElemPortion","cn","styles","Root","onClick","filter","p","map","key","Root__item_selected","Root__item","defaultProps","Item","userid","photos","status","name","followed","subscribersList","to","src","large","userPhoto","img","alt","disabled","some","button","resultCode","Users","useSelector","state","useEffect","Preloader","user__list","u","index"],"mappings":"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","file":"static/js/3.1a3fa3f5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Root\":\"styles_Root__oEpNw\",\"Root__item\":\"styles_Root__item__3mqXN\",\"Root__item_selected\":\"styles_Root__item_selected__ggYYh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Root\":\"Item_Root__3rWNJ\",\"img\":\"Item_img__23SPF\",\"button\":\"Item_button__3m9QD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"users\":\"Users_users__2Iv27\",\"user__list\":\"Users_user__list__vXYde\"};","// api\nimport { instanceAxios } from '../../utils/api';\nimport { profileAPI } from '../profile/api';\n\n// constants\nimport { STYLE_CONSOLE } from '../../constants/constants';\n\nexport const usersAPI = {\n    async getUsers(currentPage, pageSize) {\n        const response = await instanceAxios.get(`users?page=${currentPage}&count=${pageSize}`);\n\n        return response.data;\n    },\n\n    async addFriend(id) {\n         const response = await instanceAxios.post(`follow/${id}`);\n\n         return response.data;\n    },\n\n    async deleteFriend(id) {\n        const response = await instanceAxios.delete(`follow/${id}`);\n\n        return response.data;\n    },\n\n    async getProfile(userId) {\n        console.log('%cObsolete method! Please use profileAPI', STYLE_CONSOLE);\n        const response = await profileAPI.getProfile(userId);\n        return response.data;\n    }\n}\n","// api\nimport { usersAPI } from './api';\n\n// types\nimport types from './types';\n\nexport function acceptAddFriend(userId) {\n    return {\n        type: types.ADD_FRIEND,\n        userId\n    }\n}\n\nexport function acceptDeleteFriend(userId) {\n    return {\n        type: types.DELETE_FRIEND,\n        userId\n    }\n}\n\nexport function setUsers(users) {\n    return {\n        type: types.SET_USERS,\n        users\n    }\n}\n\nexport function setCurrentPage(currentPage) {\n    return {\n        type: types.SET_CURRENT_PAGE,\n        currentPage\n    }\n}\n\nexport function setTotalCount(totalCount) {\n    return {\n        type: types.SET_TOTAL_COUNT,\n        totalCount\n    }\n}\n\nexport function setToggleIsFetching(isFetching) {\n    return {\n        type: types.TOGGLE_IS_FETCHING,\n        isFetching\n    }\n}\n\nexport function setWaitIsSubscribe(isFetching, userId) {\n    return {\n        type: types.TOGGLE_IS_WAIT_SUBSCRIBE,\n        isFetching,\n        userId\n    }\n}\n\nexport function getUsersThunk(currentPage, pageSize) {\n    return async dispatch => {\n        try {\n            const response = await usersAPI.getUsers(currentPage, pageSize);\n\n            dispatch(setToggleIsFetching(false));\n            dispatch(setUsers(response.items));\n            dispatch(setTotalCount(response.totalCount));\n            dispatch(setCurrentPage(currentPage));\n        }\n        catch(e) {\n            throw new Error(e);\n        }\n    }\n}\n\nexport function deleteFriendThunk(userId) {\n    return async dispatch => {\n        try {\n            dispatch(setWaitIsSubscribe(true, userId));\n            const response = await usersAPI.deleteFriend(userId);\n            if (response.resultCode === 0) {\n                dispatch(acceptDeleteFriend(userId));\n            }\n            dispatch(setWaitIsSubscribe(false, userId));\n        }\n        catch(e) {\n            throw new Error(e);\n        }\n    }\n}\n\nexport function addFriendThunk(userId) {\n    return async dispatch => {\n        try {\n            dispatch(setWaitIsSubscribe(true, userId))\n            const response = await usersAPI.addFriend(userId);\n\n            if (response.resultCode === 0) {\n                dispatch(acceptAddFriend(userId))\n            }\n            dispatch(setWaitIsSubscribe(false, userId))\n        }\n        catch(e) {\n            throw new Error(e);\n        }\n    }\n}\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport cn from 'classnames';\nimport { useDispatch } from 'react-redux';\n\n// actions\nimport { getUsersThunk } from '../../state/users/actions';\n\nimport styles from './styles.module.css';\n\nfunction Paginator({ className, totalCount, pageSize, currentPage, portionSize }) {\n    const dispatch = useDispatch();\n    const [portionNumber, setPortionNumber] = useState(1);\n\n    const onPageChanged = (pageNumber) => {\n        dispatch(getUsersThunk(pageNumber, pageSize));\n    }\n\n    const pageCount = Math.ceil(totalCount / pageSize);\n\n    const pages = [];\n\n    for (let i = 1; i <= pageCount; i++) {\n        pages.push(i);\n    }\n\n    const portionCount = Math.ceil(pageCount / portionSize);\n    const leftMostElemPortion = (portionNumber - 1) * portionSize; // Крайний Левый элемент в порции пагинации\n    const rightMostElemPortion = portionNumber * portionSize; // Крайний Правый элемент в порции пагинации\n\n    return (\n        <ul className={cn(styles.Root, className)}>\n            {portionNumber > 1 && (\n                <button onClick={() => setPortionNumber(portionNumber - 1)}>prev</button>\n            )}\n\n            {\n                pages.filter(p => {\n                    return p >= leftMostElemPortion && p <= rightMostElemPortion\n                }).map((p, id) => {\n                    return (\n                        <li key={id}\n                            className={cn({[styles.Root__item_selected]: currentPage === p }, styles.Root__item )}\n                            onClick={() => {onPageChanged(p)}}>\n                            {p}\n                        </li>\n                    )\n                })\n            }\n\n            {portionNumber < portionCount && (\n                <button onClick={() => setPortionNumber(portionNumber + 1)}>next</button>\n            )}\n        </ul>\n    )\n}\n\nPaginator.propTypes = {\n    className: PropTypes.string,\n    totalCount: PropTypes.number.isRequired,\n    pageSize: PropTypes.number.isRequired,\n    currentPage: PropTypes.number.isRequired,\n    portionSize: PropTypes.number.isRequired,\n}\n\nPaginator.defaultProps = {\n    className: '',\n    portionSize: 10,\n}\n\nexport default Paginator;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cn from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { NavLink } from 'react-router-dom';\n\n// actions\nimport {\n    deleteFriendThunk,\n    addFriendThunk,\n} from '../../../state/users/actions';\n\n// pic\nimport userPhoto from '../../../assets/images/user.png';\n\nimport styles from './Item.module.css';\n\nfunction Item({ className, userid, photos, status, name, followed, subscribersList }) {\n    const dispatch = useDispatch();\n\n    return (\n        <li key={userid} className={cn(styles.Root, className)}>\n            <NavLink to={\"/profile/\" + userid}>\n                <img src={photos.large ? photos.large : userPhoto} className={styles.img} alt=\"\" />\n                <span>{status}</span>\n                <span>{name}</span>\n            </NavLink>\n\n            <div>\n                {\n                    followed ?\n                        <button\n                            disabled={subscribersList.some(id => id === userid)}\n                            className={styles.button}\n                            onClick={() => {\n                                dispatch(deleteFriendThunk(userid))\n                            }}>\n                            delete friend\n            </button>\n                        :\n                        <button\n                            disabled={subscribersList.some(id => id === userid)}\n                            className={styles.button} onClick={() => {\n                                dispatch(addFriendThunk(userid))\n                            }}>\n                            add friend\n            </button>\n                }\n            </div>\n        </li>\n    )\n}\n\nItem.propTypes = {\n    className: PropTypes.string,\n    userid: PropTypes.number.isRequired,\n}\n\nItem.defaultProps = {\n    className: '',\n}\n\nexport default Item;\n","import React, { useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\n// actions\nimport {\n    getUsersThunk,\n} from '../../state/users/actions';\n\n// components\nimport Preloader from '../common/Preloader/Preloader';\nimport Paginator from '../Paginator';\nimport Item from './Item';\n\nimport styles from './Users.module.css';\n\nfunction Users() {\n    const dispatch = useDispatch();\n    const pageSize = useSelector(state => state.users.pageSize);\n    const currentPage = useSelector(state => state.users.currentPage);\n    const users = useSelector(state => state.users.users);\n    const totalCount = useSelector(state => state.users.totalCount);\n    const isFetching = useSelector(state => state.users.isFetching);\n    const subscribersList = useSelector(state => state.users.subscribersList);\n\n    useEffect(() => {\n        dispatch(getUsersThunk(currentPage, pageSize));\n    }, [currentPage, dispatch, pageSize])\n\n    if (isFetching) {\n        return <Preloader />\n    }\n\n    return (\n        <div className={styles.users}>\n            {/* TODO Поправить пагинатор */}\n            <Paginator totalCount={totalCount} pageSize={pageSize} currentPage={currentPage} />\n\n            <ul className={styles.user__list}>\n                {\n                    users.map((u, index) => {\n                        return <Item\n                                    key={index}\n                                    userid={u.id}\n                                    photos={u.photos}\n                                    status={u.status}\n                                    name={u.name}\n                                    followed={u.followed}\n                                    subscribersList={subscribersList}\n                                />\n                    })\n                }\n            </ul>\n        </div>\n    )\n}\n\nexport default Users;\n","export { default } from './Users';\n"],"sourceRoot":""}